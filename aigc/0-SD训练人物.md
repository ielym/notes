# SD1.5

- `5 x 1boy + 5 x 1girl`

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689220102005-22.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689220108787-24.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689220114911-26.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689220121585-28.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689220127622-30.jpg" width="150"/>
</center>


<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689220149532-32.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689220155836-34.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689220160939-36.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689220166088-38.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689220172864-40.jpg" width="150"/>
</center>
<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689220188283-42.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689220195136-44.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689220200384-46.jpg" width="150"/>
</center>

---

# 0 其他

## 0.1 潘丢丢

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/2aec00ca48f8548053bfcf9a756732fa.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/2c557446b497780e37dccd4ac07a4cda.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/bbe590470160203292cfdfa486dabc6e.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/f9542289ab15c3e3343a714ca0b43638.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_2023071123173221.jpg" width="150"/>
</center>

- 脸 (322) ：`E:\Project\AIGC\datasets\styles\real\pandiudiu\crop_faces`
- 身体 (318)：`E:\Project\AIGC\datasets\styles\real\pandiudiu\crop_body`
- git: `dev2` ，`f802b919a167076980b12af430b31f14c9e5bb97`
- 训练轮数：`/home/nas01/luoyiming/aigc/work/exp006/weights/checkpoint-30000`
- 额外提示词：无
- 训练底模：SD1.5
- 推理分辨率：896x640

### SD1.5 推理

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689257588167-342.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689257594711-344.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689257600427-346.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689257607525-348.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689257615092-350.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689257634350-352.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689257641655-354.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689257648777-356.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689257656364-358.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689257661907-360.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689257679391-362.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689257686452-364.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689257691447-366.jpg" width="150"/>
</center>

### Majic推理

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689258016282-373.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689258023450-375.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689258031099-377.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689258041328-379.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689258047895-381.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689258061548-383.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689258077416-385.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689258088238-387.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689258093915-389.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689258103377-391.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689258121716-393.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689258133302-395.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689258146598-397.jpg" width="150"/>
</center>
# 1 优化姿态

SD1.5在不加复杂的提示词时，生成的人物姿态通常比较奇怪。如姿态不好看，多个胳膊/腿，缺少胳膊/腿等。如下图所示：

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0.jpg" width="150"/>
</center>

即使我们训练好了风格/人脸，也会受限于姿态的影响导致不美观。

## 1.1 半身/全身

首先，不管多胳膊/腿，缺少胳膊/腿，人脸，光线，风格等其他因素，只考虑整体布局的合理性和美观性，如下图majic为目标：

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689175701888-4.jpg" width="150"/>
	<img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689175723705-7.jpg" width="150"/>
</center>

分析：

- 面部，环境，衣着等都不考虑，因此prompt中相关的属性都保留下来。
- 只训练姿态，因此全身/半身两个prompt需要加入用于控制，同时也要保证在不加任何全身/半身的prompt时，姿态也应美观，所以需要增大使用空prompt的概率。

### 1.1.1 DreamBooth LoRA

- 爬取的图像质量较低，且背景，遮挡关系复杂。之前多次实验均未成功。因此本次实验采用抠图的方式。

#### exp010 

- 8e952a320f85f0a5ba2507293e9175f97117f650

- rank = 32
- `blip + wd_v14_vit` 未做删减

iter-3000:

```
结论：
1. 直接使用原始所有prompt，在推理时如果prompt比较简单，则效果较差。如果prompt和vit14比较接近，则效果较好（如第三行所示）
```



<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689219852641-1.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689219867576-4.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689219914462-9.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689219925288-11.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689219952226-15.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0.jpg" width="150"/>
</center>

#### exp011

- 9f00a69614e169274de17bd7880a6785b3cd1e5a

- rank = 32

- `blip + wd_v14_vit` ，只保留性别相关的属性:

  ![image-20230713113544208](imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/image-20230713113544208.png)

  结论：

  ```
  效果比直接使用全部prompt更好一些
  ```

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689225615001-68.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689225622830-70.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689225629175-72.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689225635970-74.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689225642074-76.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689225658466-78.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689225665432-80.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689225674345-82.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689225702344-88.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689225688271-86.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689225731142-90.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689225738846-92.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689225744693-94.jpg" width="150"/>
</center>

#### exp012 - best

- 基于 `exp011`

- 由于直接改变SD底模的表现所需的数据量较大，所以采用起别名的方式。加入 `mi_cv`

```
结论：
1. 相比直接训练SD底模，效果明显好很多。
```



<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689228383102-96.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689228390914-98.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689228397628-100.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689228405078-102.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689228414049-104.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689228429474-106.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689228435897-108.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689228441007-110.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689228446978-112.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689228452706-114.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689228469339-116.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689228476369-118.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689228483287-120.jpg" width="150"/>
</center>

#### exp013

- 使用起别名的方式。加入 `mi_cv` ，但是 `exp012` 只使用了 `girl, boy` 等词。会导致对其他词语（如姿态等）的理解，因此还要测试使用全部prompt的效果。
- 对于prompt，未做筛选，未剔除错误prompt

```
结论：
1. 效果不如exp012，前期改善姿态，还是仅保留 boy, girl 进行训练，后面再优化其他。
2. 可以发现第二行本应是男生，但生成的都是女生。这是因为男生的数据所占比例极低，prompt得不到有效学习。
3. 使用全部promt，衣服的多样性明显比 exp012差。此外，平时训练时非常容易出现不穿衣服的人，这是由于使用全部prompt时，衣服和prompt已经绑定了，测试时只使用1girl， 1boy就容易不穿衣服。
```

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689230647395-122.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689230653929-124.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689230659903-126.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689230665667-128.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689230674446-130.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689230684999-132.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689230692643-134.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689230697967-136.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689230703885-138.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689230709642-140.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689230722952-142.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689230729572-144.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689230734509-146.jpg" width="150"/>
</center>

#### exp015

- 使用yolov8目标检测，裁剪身体区域，裁剪尺寸是正方形。
- 加入 `mi_cv`
- 使用全部prompt
- 使用原图，未matting
- rank = 128

```
结论：
1. 使用未抠图的原始图像训练，人物质量明显不如抠图(exp012, exp013)，但是背景比其更丰富。
2. 容易不穿衣服，或衣服的质量较差。这一点和 exp013 相似。可能原因是因为训练时使用全部prompt，导致衣服和prompt过度绑定导致的。
3. 当输入衣服相关的详细prompt时，如第三行最后一张，人物的衣服优于 exp012和exp013
4. 与 exp013类似，男生的图像都生成了女生，与数据分布有关。
```

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689249328047-158.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689249333569-160.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689249340291-162.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689249345543-164.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689249351372-166.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689249361439-168.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689249367890-170.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689249375475-172.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689249383174-174.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689249388950-176.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689249405708-178.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689249411797-180.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689249416730-182.jpg" width="150"/>
</center>

#### exp017

- 与 `exp015` 相同，由于 `exp015` 容易不穿衣服，怀疑是由于训练时使用了太多 prompt，导致衣服和prompt过度绑定的原因。

- 因此，该实验只保留

  ```
  1girl
  1boy
  2girls
  2boys
  3girls
  3boys
  multiple_girls
  multiple_boys
  solo
  ```

- 由于数据量过大（~1w），所以没有使用工具处理prompt，直接在读数据时保留上述prompts 。

```
结论：
1. 只保留girl, boy等训练，相较于  exp015，衣服明显改善，与预期相符
```



<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689249806621-184.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689249814858-186.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689249821050-188.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689249827647-190.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689249839695-192.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689249853950-194.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689249860563-196.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689249866547-198.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689249872147-200.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689249888403-202.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689249907371-204.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689249913356-206.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689249917598-208.jpg" width="150"/>
</center>

#### exp016

- 与 `exp015` 相同，分辨率 768

```
结论：
1. 768分辨率比512的效果好非常多
2. 由于和 exp015 一样，都使用了全部prompt，因此也存在一定裸体的问题。
```

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689250280646-210.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689250287000-212.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689250292005-214.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689250297110-216.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689250303707-218.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689250313813-220.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689250319409-222.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689250324345-224.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689250329259-226.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689250333709-228.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689250348531-230.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689250354395-232.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689250359528-234.jpg" width="150"/>
</center>

#### exp018

- 与 `exp016` 相同
- 和 `exp017` 一样，只保留 `girl, boy` 等主要提示词。 测试768分辨率下的效果会不会更好（不考虑鲁棒性）

```
结论：
1. 只保留 girl, boy，在 768 上并没有提升。反而主观上认为有下降。
2. （又多训练了1000个epoch），裸体问题基本解决了，但效果不如使用全部prompt的好。
```



<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689252686714-262.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689252694566-264.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689252702105-266.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689252708602-268.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689252714415-270.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689252729450-272.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689252735900-274.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689252742997-276.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689252749053-278.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689252754179-280.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689252780655-282.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689252787601-284.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689252792369-286.jpg" width="150"/>
</center>



#### exp019

- 与 `exp017` 一样，既然768训练更好，那么测试896的情况。rank=128时，896x896是能用的最大分辨率。

```
结论：
1. 使用768x512推理，效果还不如使用 768 训练的模型。怀疑和推理分辨率有关。因此又推理了一下896x640的推理结果，好像比768推理好一些。
```



<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689253635468-288.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689253641888-290.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689253646788-292.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689253652475-294.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689253658123-296.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689253670878-298.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689253676713-300.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689253681214-302.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689253686086-304.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689253690659-306.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689253710323-308.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689253723559-310.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689253729229-312.jpg" width="150"/>
</center>

---

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689253836782-314.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689253842913-316.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689253847523-318.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689253853438-320.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689253861142-322.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689253878653-326.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689253884702-328.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689253890307-330.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689253896192-332.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689253902004-334.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689253914797-336.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689253920888-338.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689253925286-340.jpg" width="150"/>
</center>

#### exp022

- 基于 `exp016` 
- 由于 `exp018` 只保留 `girl, boy` 的效果在 768 和 512 并不相同，并且也没有有效解决裸体问题。因此再测试一下增大使用空 prompt 的效果（未删减提示词）

- 原空提示词概率 `0.1` ，该实验设置为 `0.3`

```
人脸好一些，裸体更严重
```



<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689261278169-425.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689261296362-427.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689261304025-429.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689261312944-431.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689261323000-433.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689261340579-435.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689261348771-437.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689261355544-439.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689261362737-441.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689261370262-443.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689261399800-445.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689261406569-447.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689261413883-449.jpg" width="150"/>
</center>

### 1.1.2 DreamBooth

- DreamBooth在使用多尺度或大于512分辨率时，显存不够。因此实验中都提前裁剪好512x512的图像，保证不会产生又crop导致的语义-图像不匹配问题。
- 都加入 `mi_cv`

#### exp014

- 与 `exp015` 相同，但是使用 DreamBooth

```
结论：
1. 崩了（3000-iters测试），但是之前只训练unet也不会崩这么厉害。怀疑是学习率过大导致的，需要分别测试text-encoder和unet的学习率设置。
```



<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689251932989-236.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689251941012-238.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689251946532-240.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689251952021-242.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689251958026-244.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689251968410-246.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689251975599-248.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689251980747-250.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689251986322-252.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689251991446-254.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689252002936-256.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689252014055-258.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689252018594-260.jpg" width="150"/>
</center>

#### exp020

- 与 `exp014` 相同，调整学习率：
  - 原学习率：`unet = 2e-4, text_encoder = unet * 0.2`
  - 调整后学习率：`unet = 1e-4, text_encoder = unet * 0.2`

```
结论：
1. 学习率可能还是大了
```



<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689260734968-399.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689260749967-401.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689260763478-403.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689260774166-405.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689260782819-407.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689260814184-409.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689260823905-411.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689260832224-413.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689260840649-415.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689260846764-417.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689260873704-419.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689260880830-421.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689260891306-423.jpg" width="150"/>
</center>

#### exp023

- 在 `exp020` 的基础上，再调小学习率10倍：
  - 原学习率：`unet = 1e-4, text_encoder = unet * 0.2`
  - 调整后学习率：`unet = 1e-5, text_encoder = unet * 0.2`

```
结论：
1. 和 exp020结合来看，exp020的问题确实是由于学习率过大导致的
2. 和 exp024结合来看，在男生数据极度缺少的情况下，使用全量prompt会导致男生语义的严重便宜。第二行生成的男生都女性化。
```



<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689332036348-29.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689332041059-31.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689332046641-33.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689332054745-35.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689332061439-37.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689332075531-39.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689332082304-41.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689332095554-43.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689332100801-45.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689332107026-47.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689332127988-51.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689332133651-53.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689332140020-55.jpg" width="150"/>
</center>

#### exp024

- 在 `exp023` 的基础上，只保留

  ```
  1girl
  1boy
  2girls
  2boys
  3girls
  3boys
  multiple_girls
  multiple_boys
  solo
  ```

  ```
  结论：
  1. 41000-iters 时测试，图像都是模糊的，怀疑和过拟合有关（可能学习率还是有些大）
  ```

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689331696906-1.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689331705586-3.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689331711374-5.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689331722354-7.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689331729212-9.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_5_0-1689331758213-13.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_6_0-1689331768732-15.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689331775733-17.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689331782277-19.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689331789931-21.jpg" width="150"/>
</center>

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_10_0-1689331804989-23.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_11_0-1689331810439-25.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_12_0-1689331815935-27.jpg" width="150"/>
</center>

# 999 问题记录

## 1 训练的人物容易不穿衣服

可能的原因是，训练时保留了较多的衣服的prompt，导致衣服和prompt过度绑定，推理时如果只使用 `a girl, a boy` 等简单prompt，就容易不出现衣服。

训练db-lora时易出现，训练db时不容易出现该问题。

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689247435724-148.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689247443179-150.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_7_0-1689247450142-152.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_9_0-1689247456296-154.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_8_0-1689247462199-156.jpg" width="150"/>
</center>

只保留`girl, boy` 等prompt，去掉其他所有prompt，衣服的效果有改善：

<center class="half">
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_0_0-1689249806621-184.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_1_0-1689249814858-186.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_2_0-1689249821050-188.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_3_0-1689249827647-190.jpg" width="150"/>
    <img src="imgs/0-SD%E8%AE%AD%E7%BB%83%E4%BA%BA%E7%89%A9/test_lora_4_0-1689249839695-192.jpg" width="150"/>
</center>

## 2 脸部扭曲，红眼，出现错乱区块的颜色

- 严重过拟合了
